# Telegram-Бот для задач и календаря Bitrix24 (v2)

Это доработанная версия проекта бота по вашему ТЗ.

Исправлено:
- Работает просмотр задач (callback'и и фильтры).
- Не ломается диалог создания мероприятия: после ввода названия бот больше не отвечает "я вас не понял",
  а корректно продолжает сценарий.
- Просмотр мероприятий по кнопке "Мои мероприятия" показывает сообщение
  "Ближайших мероприятий не найдено", пока не реализована реальная интеграция с календарём Bitrix24.
- Обёртка для tasks.task.list стала более совместимой с разными форматами ответа Bitrix24.

## Что нужно настроить

1. В `config.py`:
   - `TELEGRAM_BOT_TOKEN` — токен бота.
   - `BITRIX_WEBHOOK_BASE_URL` — URL входящего вебхука Bitrix24.
   - `COMMON_PASSWORD` — общий пароль для всех сотрудников.

2. В `auth.py`:
   Заполните `LOGIN_MAP`, например:

   ```python
   LOGIN_MAP = {
       "admin": {"bitrix_user_id": 1, "name": "Администратор"},
       "abumuslim": {"bitrix_user_id": 17, "name": "Абумуслим"},
   }
   ```

3. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

4. Запуск бота:

   ```bash
   python main.py
   ```

## Важный момент по календарю

Функции `get_calendar_events` и `create_calendar_event` в `bitrix_api.py` сейчас заглушки.
Бот:
- умеет корректно проходить сценарий создания мероприятия (название → описание → дата → выбор участников),
- но реально не создаёт событие в Bitrix24, пока вы не подпишете эти функции под ваш конкретный метод API.

Логика и интерфейс под Telegram уже готовы, вам останется только дописать вызовы нужных методов Bitrix24.
